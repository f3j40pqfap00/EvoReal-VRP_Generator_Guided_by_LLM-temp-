nohup: ignoring input
[2025-06-08 13:39:32] finetune_phase1.py(135) : DEBUG_MODE: False
[2025-06-08 13:39:32] finetune_phase1.py(136) : USE_CUDA: True, CUDA_DEVICE_NUM: 1
[2025-06-08 13:39:32] finetune_phase1.py(137) : env_params{'problem_size': 100, 'pomo_size': 100, 'num_total_samples': 70, 'root_dir': './dataset/train', 'use_early_stopping': True, 'tolerance': 8, 'early_stopping_threshold': 0.05}
[2025-06-08 13:39:32] finetune_phase1.py(137) : model_params{'embedding_dim': 128, 'sqrt_embedding_dim': 11.313708498984761, 'encoder_layer_num': 6, 'qkv_dim': 16, 'head_num': 8, 'logit_clipping': 10, 'ff_hidden_dim': 512, 'eval_type': 'argmax'}
[2025-06-08 13:39:32] finetune_phase1.py(137) : optimizer_params{'optimizer': {'lr': 0.0001, 'weight_decay': 1e-06}, 'scheduler': {'milestones': [100, 110, 120, 130, 140, 150, 160, 170, 180, 190], 'gamma': 0.9}}
[2025-06-08 13:39:32] finetune_phase1.py(137) : trainer_params{'use_cuda': True, 'cuda_device_num': 1, 'train_episodes': 500, 'epochs': 200, 'train_batch_size': 64, 'prev_model_path': None, 'logging': {'model_save_interval': 5}, 'model_load': {'enable': True, 'path': './POMO/result/saved_CVRP100_model', 'epoch': 30500}}
[2025-06-08 13:39:32] finetune_phase1.py(137) : logger_params{'log_file': {'desc': 'direct_finetune(phase1)', 'filename': 'run_log', 'filepath': './result/20250608_133932_direct_finetune(phase1)'}}
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTrainer.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
[2025-06-08 13:39:33] CVRPTrainer.py(64) : Saved Model Loaded !!
[2025-06-08 13:39:33] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:39:33] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
/home/ntu/CVRP/POMO_CVRP_p1/POMO/generate_instance_p1.py:156: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:278.)
  depot_xy = torch.tensor(depot_xy).float().unsqueeze(1)         # (batch, 1, 2)
[2025-06-08 13:39:39] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:39:44] CVRPTrainer.py(104) : Epoch   1: Train 500/500(100.0%)  Score: 0.2654,  Loss: -0.0323
[2025-06-08 13:39:44] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:39:44] CVRPTrainer.py(184) : Epoch   1/200: Time Est.: Elapsed[0.20m], Remain[38.92m]
[2025-06-08 13:39:44] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:39:44] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:39:50] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:39:56] CVRPTrainer.py(104) : Epoch   2: Train 500/500(100.0%)  Score: 0.2639,  Loss: -0.0127
[2025-06-08 13:39:56] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:39:56] CVRPTrainer.py(184) : Epoch   2/200: Time Est.: Elapsed[0.38m], Remain[37.89m]
[2025-06-08 13:39:56] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:39:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:40:01] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:40:06] CVRPTrainer.py(104) : Epoch   3: Train 500/500(100.0%)  Score: 0.2562,  Loss: -0.0101
[2025-06-08 13:40:06] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:40:06] CVRPTrainer.py(184) : Epoch   3/200: Time Est.: Elapsed[0.56m], Remain[36.58m]
[2025-06-08 13:40:06] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:40:06] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:40:12] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:40:17] CVRPTrainer.py(104) : Epoch   4: Train 500/500(100.0%)  Score: 0.2621,  Loss: -0.0097
[2025-06-08 13:40:17] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:40:17] CVRPTrainer.py(184) : Epoch   4/200: Time Est.: Elapsed[0.74m], Remain[36.16m]
[2025-06-08 13:40:17] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:40:17] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:40:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:40:28] CVRPTrainer.py(104) : Epoch   5: Train 500/500(100.0%)  Score: 0.2540,  Loss: -0.0084
[2025-06-08 13:40:28] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:40:28] CVRPTrainer.py(184) : Epoch   5/200: Time Est.: Elapsed[0.92m], Remain[35.76m]
[2025-06-08 13:40:28] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 5 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.030, aug_score:29.101
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.142, aug_score:15.142
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.888, aug_score:13.888
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:59.056, aug_score:58.178
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.531, aug_score:29.489
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.203, aug_score:14.050
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.592, aug_score:16.501
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.292, aug_score:46.748
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.747, aug_score:17.483
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.090, aug_score:14.832
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.554, aug_score:21.301
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.613, aug_score:49.981
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.286, aug_score:52.286
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.797, aug_score:26.434
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.574, aug_score:25.574
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.239, aug_score:18.039
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.418, aug_score:49.162
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.485, aug_score:61.955
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.750, aug_score:32.105
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.641, aug_score:121.401
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.276, aug_score:42.851
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.864, aug_score:29.525
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:88.895, aug_score:88.104
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.061, aug_score:42.260
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.395, aug_score:41.284
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.679, aug_score:28.679
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:84.262, aug_score:83.396
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:40.702, aug_score:39.379
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.494, aug_score:37.300
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:23.081, aug_score:22.593
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:104.717, aug_score:104.133
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:54.441, aug_score:52.873
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.871, aug_score:38.002
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:24.941, aug_score:24.512
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.668, aug_score:29.326
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:104.067, aug_score:103.461
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:132.179, aug_score:84.936
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.629, aug_score:31.593
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:35.615, aug_score:34.475
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:155.544, aug_score:154.473
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:52.682, aug_score:48.845
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.387, aug_score:30.387
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:27.115, aug_score:26.804
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:160.611, aug_score:159.326
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:76.500, aug_score:75.680
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.621, aug_score:45.478
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.855, aug_score:25.206
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:80.411, aug_score:79.891
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.973, aug_score:66.357
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.727, aug_score:31.727
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:261.394, aug_score:258.276
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:86.230, aug_score:80.687
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:286.429, aug_score:78.825
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:47.653, aug_score:38.481
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:196.194, aug_score:186.943
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:115.434, aug_score:115.434
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:103.911, aug_score:101.128
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:67.910, aug_score:67.377
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:243.594, aug_score:235.332
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:150.413, aug_score:142.944
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:92.796, aug_score:92.796
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:73.420, aug_score:73.420
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:141.740, aug_score:128.081
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:200.921, aug_score:180.078
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:118.059, aug_score:112.223
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.900, aug_score:111.560
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:62.335, aug_score:54.151
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:206.393, aug_score:203.410
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:152.431, aug_score:152.431
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:145.511, aug_score:139.933
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_5.json
[Eval] Eval for epoch 5 finished with exit code 0
[2025-06-08 13:41:21] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 17.3022%.
[2025-06-08 13:41:21] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 5 is 17.30220487727922!
[2025-06-08 13:41:21] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:41:21] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:41:27] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:41:33] CVRPTrainer.py(104) : Epoch   6: Train 500/500(100.0%)  Score: 0.2553,  Loss: -0.0081
[2025-06-08 13:41:33] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:41:33] CVRPTrainer.py(184) : Epoch   6/200: Time Est.: Elapsed[2.01m], Remain[1.08h]
[2025-06-08 13:41:33] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:41:33] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:41:38] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:41:44] CVRPTrainer.py(104) : Epoch   7: Train 500/500(100.0%)  Score: 0.2632,  Loss: -0.0077
[2025-06-08 13:41:44] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:41:44] CVRPTrainer.py(184) : Epoch   7/200: Time Est.: Elapsed[2.19m], Remain[1.01h]
[2025-06-08 13:41:44] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:41:44] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:41:49] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:41:55] CVRPTrainer.py(104) : Epoch   8: Train 500/500(100.0%)  Score: 0.2688,  Loss: -0.0073
[2025-06-08 13:41:55] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:41:55] CVRPTrainer.py(184) : Epoch   8/200: Time Est.: Elapsed[2.37m], Remain[56.79m]
[2025-06-08 13:41:55] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:41:55] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:42:00] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:42:05] CVRPTrainer.py(104) : Epoch   9: Train 500/500(100.0%)  Score: 0.2660,  Loss: -0.0069
[2025-06-08 13:42:05] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:42:05] CVRPTrainer.py(184) : Epoch   9/200: Time Est.: Elapsed[2.55m], Remain[54.04m]
[2025-06-08 13:42:05] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:42:05] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:42:12] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:42:17] CVRPTrainer.py(104) : Epoch  10: Train 500/500(100.0%)  Score: 0.2634,  Loss: -0.0077
[2025-06-08 13:42:17] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:42:17] CVRPTrainer.py(184) : Epoch  10/200: Time Est.: Elapsed[2.74m], Remain[52.11m]
[2025-06-08 13:42:17] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 10 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.973, aug_score:29.132
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.215, aug_score:15.215
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.538, aug_score:13.268
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.819, aug_score:58.275
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.735, aug_score:29.381
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.213, aug_score:14.060
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.296, aug_score:16.270
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.673, aug_score:46.621
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.506, aug_score:17.473
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.968, aug_score:14.799
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.458, aug_score:21.353
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.726, aug_score:50.298
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:53.372, aug_score:52.205
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.701, aug_score:26.342
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.817, aug_score:25.554
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.296, aug_score:18.090
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.085, aug_score:49.484
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.369, aug_score:61.883
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.748, aug_score:32.245
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.876, aug_score:120.814
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.842, aug_score:42.842
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.926, aug_score:29.165
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:87.993, aug_score:87.993
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.605, aug_score:42.020
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.171, aug_score:40.957
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.908, aug_score:28.667
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:83.147, aug_score:83.147
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.994, aug_score:39.306
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.601, aug_score:36.932
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.678, aug_score:22.678
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:104.552, aug_score:103.957
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:54.075, aug_score:53.054
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.655, aug_score:37.768
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:24.735, aug_score:24.321
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.988, aug_score:29.385
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.631, aug_score:103.464
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:114.272, aug_score:84.501
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.593, aug_score:31.994
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:35.804, aug_score:34.272
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:155.144, aug_score:154.260
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:52.806, aug_score:48.367
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.188, aug_score:30.188
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.597, aug_score:26.597
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:160.841, aug_score:159.283
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:75.989, aug_score:75.834
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:47.264, aug_score:46.075
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:27.180, aug_score:25.578
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:80.262, aug_score:79.635
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.298, aug_score:67.223
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.740, aug_score:31.740
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:261.620, aug_score:260.408
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:86.147, aug_score:81.161
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:92.239, aug_score:77.474
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:45.642, aug_score:39.529
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:197.694, aug_score:186.120
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:114.228, aug_score:114.228
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:112.832, aug_score:105.585
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:70.168, aug_score:67.294
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:244.548, aug_score:235.248
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:150.225, aug_score:137.942
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:93.567, aug_score:93.567
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:74.535, aug_score:74.535
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:153.434, aug_score:121.202
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:200.653, aug_score:178.977
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:120.160, aug_score:112.990
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:121.616, aug_score:109.560
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:63.349, aug_score:51.782
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:204.443, aug_score:202.153
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:155.592, aug_score:155.592
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:146.665, aug_score:142.635
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_10.json
[Eval] Eval for epoch 10 finished with exit code 0
[2025-06-08 13:43:11] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 17.1415%.
[2025-06-08 13:43:11] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 10 is 17.141521837293837!
[2025-06-08 13:43:11] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.160683
[2025-06-08 13:43:11] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:43:11] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:43:16] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:43:21] CVRPTrainer.py(104) : Epoch  11: Train 500/500(100.0%)  Score: 0.2580,  Loss: -0.0074
[2025-06-08 13:43:21] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:43:21] CVRPTrainer.py(184) : Epoch  11/200: Time Est.: Elapsed[3.81m], Remain[1.09h]
[2025-06-08 13:43:21] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:43:21] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:43:27] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:43:32] CVRPTrainer.py(104) : Epoch  12: Train 500/500(100.0%)  Score: 0.2643,  Loss: -0.0072
[2025-06-08 13:43:32] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:43:32] CVRPTrainer.py(184) : Epoch  12/200: Time Est.: Elapsed[4.00m], Remain[1.04h]
[2025-06-08 13:43:32] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:43:32] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:43:38] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:43:43] CVRPTrainer.py(104) : Epoch  13: Train 500/500(100.0%)  Score: 0.2639,  Loss: -0.0068
[2025-06-08 13:43:43] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:43:43] CVRPTrainer.py(184) : Epoch  13/200: Time Est.: Elapsed[4.17m], Remain[59.98m]
[2025-06-08 13:43:43] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:43:43] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:43:49] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:43:54] CVRPTrainer.py(104) : Epoch  14: Train 500/500(100.0%)  Score: 0.2712,  Loss: -0.0068
[2025-06-08 13:43:54] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:43:54] CVRPTrainer.py(184) : Epoch  14/200: Time Est.: Elapsed[4.36m], Remain[57.91m]
[2025-06-08 13:43:54] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:43:54] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:44:00] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:44:05] CVRPTrainer.py(104) : Epoch  15: Train 500/500(100.0%)  Score: 0.2529,  Loss: -0.0072
[2025-06-08 13:44:05] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:44:05] CVRPTrainer.py(184) : Epoch  15/200: Time Est.: Elapsed[4.54m], Remain[56.03m]
[2025-06-08 13:44:05] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 15 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.779, aug_score:29.216
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.270, aug_score:15.221
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.781, aug_score:13.694
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.778, aug_score:58.128
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.740, aug_score:29.362
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.137, aug_score:13.965
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.177, aug_score:16.177
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.805, aug_score:46.240
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.308, aug_score:17.405
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.996, aug_score:14.948
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.570, aug_score:21.297
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.779, aug_score:49.779
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.620, aug_score:52.605
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.836, aug_score:26.251
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.777, aug_score:25.645
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.165, aug_score:17.851
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.762, aug_score:48.529
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.267, aug_score:61.218
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.936, aug_score:32.342
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.751, aug_score:120.751
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.400, aug_score:42.815
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.452, aug_score:29.273
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:88.047, aug_score:86.949
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.579, aug_score:42.284
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.266, aug_score:41.174
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.987, aug_score:28.987
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:83.519, aug_score:82.846
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.906, aug_score:39.087
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.570, aug_score:37.316
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.819, aug_score:22.528
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:104.013, aug_score:103.769
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:53.241, aug_score:52.535
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.648, aug_score:37.936
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.041, aug_score:24.415
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.066, aug_score:29.620
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.579, aug_score:103.120
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:91.119, aug_score:83.539
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.766, aug_score:32.157
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:35.553, aug_score:34.123
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:154.652, aug_score:153.834
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:50.384, aug_score:48.428
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.574, aug_score:30.053
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.744, aug_score:26.473
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:162.007, aug_score:158.210
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:75.887, aug_score:75.104
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.793, aug_score:45.785
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:27.226, aug_score:25.448
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:79.596, aug_score:79.431
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.406, aug_score:67.314
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.452, aug_score:31.452
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:261.207, aug_score:258.415
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:86.132, aug_score:80.543
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:83.630, aug_score:82.207
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:45.682, aug_score:40.318
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:198.407, aug_score:188.286
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:116.632, aug_score:116.614
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:117.848, aug_score:106.197
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:69.845, aug_score:68.240
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:244.418, aug_score:234.879
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:151.158, aug_score:142.273
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:91.020, aug_score:91.020
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:74.517, aug_score:73.824
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:139.250, aug_score:120.136
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:199.194, aug_score:178.863
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.996, aug_score:111.902
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:121.575, aug_score:110.121
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:64.450, aug_score:53.467
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:206.381, aug_score:201.688
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:160.999, aug_score:160.999
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:148.860, aug_score:143.824
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_15.json
[Eval] Eval for epoch 15 finished with exit code 0
[2025-06-08 13:44:59] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 17.3194%.
[2025-06-08 13:44:59] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 15 is 17.319357673106353!
[2025-06-08 13:44:59] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.177836
[2025-06-08 13:44:59] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 17.1415%, current = 17.3194%. (1/8)
[2025-06-08 13:44:59] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:44:59] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:45:04] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:45:10] CVRPTrainer.py(104) : Epoch  16: Train 500/500(100.0%)  Score: 0.2544,  Loss: -0.0066
[2025-06-08 13:45:10] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:45:10] CVRPTrainer.py(184) : Epoch  16/200: Time Est.: Elapsed[5.62m], Remain[1.08h]
[2025-06-08 13:45:10] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:45:10] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:45:15] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:45:21] CVRPTrainer.py(104) : Epoch  17: Train 500/500(100.0%)  Score: 0.2511,  Loss: -0.0062
[2025-06-08 13:45:21] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:45:21] CVRPTrainer.py(184) : Epoch  17/200: Time Est.: Elapsed[5.80m], Remain[1.04h]
[2025-06-08 13:45:21] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:45:21] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:45:26] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:45:31] CVRPTrainer.py(104) : Epoch  18: Train 500/500(100.0%)  Score: 0.2650,  Loss: -0.0060
[2025-06-08 13:45:31] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:45:31] CVRPTrainer.py(184) : Epoch  18/200: Time Est.: Elapsed[5.98m], Remain[1.01h]
[2025-06-08 13:45:31] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:45:31] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:45:37] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:45:43] CVRPTrainer.py(104) : Epoch  19: Train 500/500(100.0%)  Score: 0.2607,  Loss: -0.0070
[2025-06-08 13:45:43] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:45:43] CVRPTrainer.py(184) : Epoch  19/200: Time Est.: Elapsed[6.17m], Remain[58.75m]
[2025-06-08 13:45:43] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:45:43] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:45:49] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:45:54] CVRPTrainer.py(104) : Epoch  20: Train 500/500(100.0%)  Score: 0.2568,  Loss: -0.0064
[2025-06-08 13:45:54] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:45:54] CVRPTrainer.py(184) : Epoch  20/200: Time Est.: Elapsed[6.35m], Remain[57.17m]
[2025-06-08 13:45:54] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 20 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.661, aug_score:29.171
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.341, aug_score:15.206
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.619, aug_score:13.546
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.865, aug_score:58.118
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.866, aug_score:29.235
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.165, aug_score:14.035
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.179, aug_score:16.179
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.886, aug_score:46.161
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.247, aug_score:17.368
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.114, aug_score:14.914
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.234, aug_score:21.137
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.169, aug_score:49.169
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.731, aug_score:51.731
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.387, aug_score:26.341
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.789, aug_score:25.789
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.102, aug_score:18.060
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.829, aug_score:48.807
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.278, aug_score:61.464
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.997, aug_score:32.209
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.722, aug_score:120.356
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.705, aug_score:42.705
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.552, aug_score:29.060
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:87.429, aug_score:87.429
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.587, aug_score:42.379
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.109, aug_score:40.910
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.234, aug_score:29.141
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:83.363, aug_score:82.067
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.579, aug_score:38.862
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.502, aug_score:37.051
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.636, aug_score:22.514
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:103.708, aug_score:103.432
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.915, aug_score:52.340
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.428, aug_score:38.009
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.204, aug_score:24.392
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.046, aug_score:29.436
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.814, aug_score:102.593
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:89.537, aug_score:83.524
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.405, aug_score:31.995
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:35.682, aug_score:33.824
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:153.495, aug_score:152.614
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:49.782, aug_score:48.237
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.575, aug_score:30.324
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.548, aug_score:26.548
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:161.489, aug_score:158.010
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:75.898, aug_score:74.910
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.810, aug_score:45.684
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.346, aug_score:25.222
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:80.141, aug_score:79.175
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.571, aug_score:66.757
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.355, aug_score:32.355
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:262.193, aug_score:256.464
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:85.755, aug_score:81.250
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:93.186, aug_score:82.958
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:44.371, aug_score:38.157
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:197.240, aug_score:188.238
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:118.361, aug_score:115.539
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:109.651, aug_score:104.264
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:70.242, aug_score:68.388
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:244.649, aug_score:235.615
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:151.305, aug_score:139.082
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:97.831, aug_score:95.557
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:74.496, aug_score:74.496
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:133.701, aug_score:121.051
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:221.265, aug_score:174.874
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:122.491, aug_score:112.065
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:122.853, aug_score:104.226
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:61.626, aug_score:60.774
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:205.007, aug_score:201.372
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:169.518, aug_score:168.679
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:146.980, aug_score:141.864
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_20.json
[Eval] Eval for epoch 20 finished with exit code 0
[2025-06-08 13:46:48] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 17.2895%.
[2025-06-08 13:46:48] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 20 is 17.289468198018483!
[2025-06-08 13:46:48] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.029889
[2025-06-08 13:46:48] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 17.1415%, current = 17.2895%. (2/8)
[2025-06-08 13:46:48] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:46:48] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:46:53] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:46:59] CVRPTrainer.py(104) : Epoch  21: Train 500/500(100.0%)  Score: 0.2531,  Loss: -0.0062
[2025-06-08 13:46:59] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:46:59] CVRPTrainer.py(184) : Epoch  21/200: Time Est.: Elapsed[7.43m], Remain[1.06h]
[2025-06-08 13:46:59] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:46:59] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:47:04] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:47:10] CVRPTrainer.py(104) : Epoch  22: Train 500/500(100.0%)  Score: 0.2602,  Loss: -0.0069
[2025-06-08 13:47:10] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:47:10] CVRPTrainer.py(184) : Epoch  22/200: Time Est.: Elapsed[7.62m], Remain[1.03h]
[2025-06-08 13:47:10] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:47:10] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:47:15] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:47:21] CVRPTrainer.py(104) : Epoch  23: Train 500/500(100.0%)  Score: 0.2523,  Loss: -0.0071
[2025-06-08 13:47:21] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:47:21] CVRPTrainer.py(184) : Epoch  23/200: Time Est.: Elapsed[7.80m], Remain[1.00h]
[2025-06-08 13:47:21] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:47:21] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:47:27] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:47:32] CVRPTrainer.py(104) : Epoch  24: Train 500/500(100.0%)  Score: 0.2570,  Loss: -0.0059
[2025-06-08 13:47:32] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:47:32] CVRPTrainer.py(184) : Epoch  24/200: Time Est.: Elapsed[7.99m], Remain[58.57m]
[2025-06-08 13:47:32] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:47:32] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:47:37] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:47:42] CVRPTrainer.py(104) : Epoch  25: Train 500/500(100.0%)  Score: 0.2593,  Loss: -0.0061
[2025-06-08 13:47:42] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:47:42] CVRPTrainer.py(184) : Epoch  25/200: Time Est.: Elapsed[8.16m], Remain[57.12m]
[2025-06-08 13:47:42] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 25 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.774, aug_score:29.018
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.341, aug_score:15.303
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.676, aug_score:13.533
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.912, aug_score:58.425
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.548, aug_score:29.341
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.109, aug_score:13.994
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.116, aug_score:16.116
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.235, aug_score:46.182
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.695, aug_score:17.420
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.140, aug_score:14.721
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.243, aug_score:21.243
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.331, aug_score:49.004
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.660, aug_score:52.151
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.465, aug_score:26.293
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.949, aug_score:25.832
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.031, aug_score:17.924
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.485, aug_score:48.197
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.336, aug_score:61.529
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.848, aug_score:32.269
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.756, aug_score:120.492
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.707, aug_score:42.707
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.458, aug_score:29.274
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:87.263, aug_score:87.260
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.186, aug_score:41.979
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.005, aug_score:40.866
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.865, aug_score:28.865
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:82.347, aug_score:82.273
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.721, aug_score:38.823
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.833, aug_score:36.833
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.669, aug_score:22.648
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:104.002, aug_score:103.550
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.884, aug_score:51.709
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.482, aug_score:37.803
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.163, aug_score:24.403
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.843, aug_score:29.408
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.138, aug_score:102.227
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:90.794, aug_score:82.918
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.760, aug_score:31.611
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:35.275, aug_score:34.337
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:155.180, aug_score:153.092
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:49.944, aug_score:48.393
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.788, aug_score:29.788
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.447, aug_score:26.249
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:159.721, aug_score:158.091
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:75.870, aug_score:74.627
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.421, aug_score:45.535
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.419, aug_score:25.300
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.640, aug_score:78.375
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:66.694, aug_score:65.826
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.372, aug_score:31.372
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:260.157, aug_score:255.279
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:85.453, aug_score:79.578
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:89.414, aug_score:78.290
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:40.704, aug_score:35.423
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:193.233, aug_score:187.387
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:120.028, aug_score:113.278
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:101.147, aug_score:101.147
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:69.336, aug_score:67.523
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:245.037, aug_score:235.230
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:153.710, aug_score:144.461
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:95.386, aug_score:95.386
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:74.158, aug_score:73.877
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:147.936, aug_score:122.267
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:217.530, aug_score:173.247
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:120.295, aug_score:111.564
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:114.729, aug_score:98.848
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:59.486, aug_score:56.135
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:205.414, aug_score:203.600
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:155.859, aug_score:151.184
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:147.329, aug_score:140.527
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_25.json
[Eval] Eval for epoch 25 finished with exit code 0
[2025-06-08 13:48:36] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.2123%.
[2025-06-08 13:48:36] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 25 is 16.2123438385264!
[2025-06-08 13:48:36] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 1.077124
[2025-06-08 13:48:36] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:48:36] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:48:41] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:48:46] CVRPTrainer.py(104) : Epoch  26: Train 500/500(100.0%)  Score: 0.2653,  Loss: -0.0072
[2025-06-08 13:48:46] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:48:46] CVRPTrainer.py(184) : Epoch  26/200: Time Est.: Elapsed[9.23m], Remain[1.03h]
[2025-06-08 13:48:46] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:48:46] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:48:52] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:48:57] CVRPTrainer.py(104) : Epoch  27: Train 500/500(100.0%)  Score: 0.2595,  Loss: -0.0066
[2025-06-08 13:48:57] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:48:57] CVRPTrainer.py(184) : Epoch  27/200: Time Est.: Elapsed[9.41m], Remain[1.00h]
[2025-06-08 13:48:57] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:48:57] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:49:03] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:49:08] CVRPTrainer.py(104) : Epoch  28: Train 500/500(100.0%)  Score: 0.2616,  Loss: -0.0061
[2025-06-08 13:49:08] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:49:08] CVRPTrainer.py(184) : Epoch  28/200: Time Est.: Elapsed[9.59m], Remain[58.94m]
[2025-06-08 13:49:08] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:49:08] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:49:14] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:49:19] CVRPTrainer.py(104) : Epoch  29: Train 500/500(100.0%)  Score: 0.2711,  Loss: -0.0061
[2025-06-08 13:49:19] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:49:19] CVRPTrainer.py(184) : Epoch  29/200: Time Est.: Elapsed[9.78m], Remain[57.65m]
[2025-06-08 13:49:19] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:49:19] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:49:25] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:49:30] CVRPTrainer.py(104) : Epoch  30: Train 500/500(100.0%)  Score: 0.2534,  Loss: -0.0065
[2025-06-08 13:49:30] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:49:30] CVRPTrainer.py(184) : Epoch  30/200: Time Est.: Elapsed[9.95m], Remain[56.39m]
[2025-06-08 13:49:30] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 30 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.702, aug_score:29.184
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.302, aug_score:15.216
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.631, aug_score:13.265
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.726, aug_score:58.497
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.442, aug_score:29.262
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.126, aug_score:13.802
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.247, aug_score:16.063
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.177, aug_score:46.040
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.826, aug_score:17.465
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.213, aug_score:14.779
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.359, aug_score:21.276
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.998, aug_score:49.409
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.635, aug_score:51.916
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.545, aug_score:26.294
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.921, aug_score:25.885
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.147, aug_score:18.052
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.278, aug_score:48.139
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.543, aug_score:61.246
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.929, aug_score:32.264
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.583, aug_score:120.583
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.686, aug_score:42.686
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.805, aug_score:29.184
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.884, aug_score:86.758
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.223, aug_score:41.590
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.323, aug_score:40.701
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.204, aug_score:29.085
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:82.050, aug_score:81.880
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.210, aug_score:38.524
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.756, aug_score:36.756
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.714, aug_score:22.605
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:103.027, aug_score:103.027
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.414, aug_score:51.965
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.087, aug_score:37.713
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.039, aug_score:24.490
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.766, aug_score:29.706
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.029, aug_score:101.803
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:99.590, aug_score:82.448
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.186, aug_score:31.378
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.715, aug_score:34.131
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:154.638, aug_score:152.250
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.748, aug_score:47.653
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.079, aug_score:29.763
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.502, aug_score:26.463
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:158.665, aug_score:157.791
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.892, aug_score:74.370
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.668, aug_score:45.258
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.464, aug_score:25.339
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.311, aug_score:77.816
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.269, aug_score:66.394
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.511, aug_score:31.511
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:256.205, aug_score:253.492
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.602, aug_score:79.315
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:88.504, aug_score:77.769
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:42.233, aug_score:37.753
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:193.155, aug_score:181.109
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:119.407, aug_score:115.630
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:101.923, aug_score:101.114
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:69.706, aug_score:68.057
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:234.431, aug_score:232.696
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:149.885, aug_score:145.153
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:94.796, aug_score:94.748
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:71.807, aug_score:71.807
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:144.593, aug_score:120.425
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:207.526, aug_score:172.486
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.704, aug_score:110.806
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:116.589, aug_score:97.618
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:60.412, aug_score:55.670
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:206.424, aug_score:199.142
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:163.916, aug_score:152.711
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:148.274, aug_score:142.224
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_30.json
[Eval] Eval for epoch 30 finished with exit code 0
[2025-06-08 13:50:23] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.0338%.
[2025-06-08 13:50:23] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 30 is 16.033821373779237!
[2025-06-08 13:50:23] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.178522
[2025-06-08 13:50:23] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:50:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:50:29] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:50:34] CVRPTrainer.py(104) : Epoch  31: Train 500/500(100.0%)  Score: 0.2538,  Loss: -0.0062
[2025-06-08 13:50:34] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:50:34] CVRPTrainer.py(184) : Epoch  31/200: Time Est.: Elapsed[11.03m], Remain[1.00h]
[2025-06-08 13:50:34] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:50:34] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:50:40] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:50:45] CVRPTrainer.py(104) : Epoch  32: Train 500/500(100.0%)  Score: 0.2635,  Loss: -0.0057
[2025-06-08 13:50:45] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:50:45] CVRPTrainer.py(184) : Epoch  32/200: Time Est.: Elapsed[11.21m], Remain[58.86m]
[2025-06-08 13:50:45] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:50:45] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:50:51] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:50:56] CVRPTrainer.py(104) : Epoch  33: Train 500/500(100.0%)  Score: 0.2459,  Loss: -0.0060
[2025-06-08 13:50:56] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:50:56] CVRPTrainer.py(184) : Epoch  33/200: Time Est.: Elapsed[11.39m], Remain[57.66m]
[2025-06-08 13:50:56] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:50:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:51:02] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:51:07] CVRPTrainer.py(104) : Epoch  34: Train 500/500(100.0%)  Score: 0.2597,  Loss: -0.0056
[2025-06-08 13:51:07] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:51:07] CVRPTrainer.py(184) : Epoch  34/200: Time Est.: Elapsed[11.57m], Remain[56.50m]
[2025-06-08 13:51:07] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:51:07] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:51:13] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:51:18] CVRPTrainer.py(104) : Epoch  35: Train 500/500(100.0%)  Score: 0.2553,  Loss: -0.0061
[2025-06-08 13:51:18] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:51:18] CVRPTrainer.py(184) : Epoch  35/200: Time Est.: Elapsed[11.75m], Remain[55.41m]
[2025-06-08 13:51:18] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 35 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.572, aug_score:28.723
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.341, aug_score:15.240
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.631, aug_score:13.246
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.657, aug_score:58.209
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.724, aug_score:29.294
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.291, aug_score:13.906
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.158, aug_score:16.123
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.292, aug_score:46.136
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.919, aug_score:17.397
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.131, aug_score:14.821
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.300, aug_score:21.300
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.765, aug_score:49.247
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.769, aug_score:51.544
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.666, aug_score:26.235
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.854, aug_score:25.689
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.250, aug_score:17.953
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.997, aug_score:48.198
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.330, aug_score:61.450
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.945, aug_score:32.112
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.668, aug_score:121.322
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.663, aug_score:42.663
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.027, aug_score:28.945
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.735, aug_score:86.735
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.071, aug_score:42.092
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.271, aug_score:40.741
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.149, aug_score:29.102
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.877, aug_score:81.877
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.824, aug_score:38.599
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.115, aug_score:36.793
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.644, aug_score:22.644
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:102.820, aug_score:102.385
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.602, aug_score:51.599
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.095, aug_score:37.887
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.079, aug_score:24.435
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.739, aug_score:29.264
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.112, aug_score:102.093
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:95.731, aug_score:82.070
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.614, aug_score:31.812
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.938, aug_score:33.978
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:153.714, aug_score:152.069
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:49.052, aug_score:47.567
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.187, aug_score:29.905
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.568, aug_score:26.475
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:159.572, aug_score:156.837
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:75.679, aug_score:74.674
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.616, aug_score:45.382
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.705, aug_score:25.501
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.538, aug_score:78.023
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.631, aug_score:67.517
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.209, aug_score:31.209
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:257.507, aug_score:252.916
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.200, aug_score:79.912
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:88.484, aug_score:76.955
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:42.626, aug_score:38.177
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:195.135, aug_score:187.729
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:116.774, aug_score:114.290
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:103.309, aug_score:102.268
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:69.203, aug_score:68.249
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:244.418, aug_score:235.424
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:147.287, aug_score:146.123
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:95.609, aug_score:95.609
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:72.291, aug_score:72.291
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:137.951, aug_score:125.362
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:205.341, aug_score:171.372
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:120.447, aug_score:111.898
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:117.394, aug_score:101.880
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:61.359, aug_score:55.595
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:203.662, aug_score:198.205
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:164.517, aug_score:156.068
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:147.781, aug_score:139.846
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_35.json
[Eval] Eval for epoch 35 finished with exit code 0
[2025-06-08 13:52:12] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.2968%.
[2025-06-08 13:52:12] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 35 is 16.296754616861023!
[2025-06-08 13:52:12] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.262933
[2025-06-08 13:52:12] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 16.0338%, current = 16.2968%. (1/8)
[2025-06-08 13:52:12] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:52:12] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:52:18] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:52:23] CVRPTrainer.py(104) : Epoch  36: Train 500/500(100.0%)  Score: 0.2596,  Loss: -0.0057
[2025-06-08 13:52:23] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:52:23] CVRPTrainer.py(184) : Epoch  36/200: Time Est.: Elapsed[12.85m], Remain[58.52m]
[2025-06-08 13:52:23] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:52:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:52:29] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:52:35] CVRPTrainer.py(104) : Epoch  37: Train 500/500(100.0%)  Score: 0.2634,  Loss: -0.0060
[2025-06-08 13:52:35] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:52:35] CVRPTrainer.py(184) : Epoch  37/200: Time Est.: Elapsed[13.03m], Remain[57.42m]
[2025-06-08 13:52:35] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:52:35] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:52:40] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:52:46] CVRPTrainer.py(104) : Epoch  38: Train 500/500(100.0%)  Score: 0.2575,  Loss: -0.0060
[2025-06-08 13:52:46] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:52:46] CVRPTrainer.py(184) : Epoch  38/200: Time Est.: Elapsed[13.22m], Remain[56.35m]
[2025-06-08 13:52:46] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:52:46] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:52:51] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:52:56] CVRPTrainer.py(104) : Epoch  39: Train 500/500(100.0%)  Score: 0.2554,  Loss: -0.0058
[2025-06-08 13:52:56] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:52:56] CVRPTrainer.py(184) : Epoch  39/200: Time Est.: Elapsed[13.40m], Remain[55.30m]
[2025-06-08 13:52:56] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:52:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:53:02] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:53:07] CVRPTrainer.py(104) : Epoch  40: Train 500/500(100.0%)  Score: 0.2539,  Loss: -0.0056
[2025-06-08 13:53:07] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:53:07] CVRPTrainer.py(184) : Epoch  40/200: Time Est.: Elapsed[13.57m], Remain[54.30m]
[2025-06-08 13:53:07] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 40 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.678, aug_score:28.853
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.386, aug_score:15.283
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.612, aug_score:13.321
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.300, aug_score:58.300
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.911, aug_score:29.294
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.257, aug_score:13.940
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.136, aug_score:16.101
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.730, aug_score:46.217
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.660, aug_score:17.466
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.227, aug_score:14.832
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.197, aug_score:21.171
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.616, aug_score:48.604
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.434, aug_score:51.748
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.592, aug_score:26.245
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.014, aug_score:25.989
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.131, aug_score:17.988
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.394, aug_score:47.938
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.587, aug_score:61.255
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.837, aug_score:32.184
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.561, aug_score:120.572
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.822, aug_score:42.592
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.929, aug_score:28.725
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.831, aug_score:86.831
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.763, aug_score:42.375
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.231, aug_score:40.985
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.081, aug_score:28.821
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:82.050, aug_score:81.726
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.938, aug_score:38.284
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.942, aug_score:36.617
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.837, aug_score:22.582
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:102.124, aug_score:102.124
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.565, aug_score:51.565
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.945, aug_score:37.554
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.110, aug_score:24.425
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.675, aug_score:29.549
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.427, aug_score:102.007
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:92.676, aug_score:81.800
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.213, aug_score:31.484
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.523, aug_score:34.131
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:153.139, aug_score:151.078
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:47.737, aug_score:47.737
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.833, aug_score:29.607
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.554, aug_score:26.181
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:158.444, aug_score:158.444
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.852, aug_score:73.655
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.495, aug_score:45.105
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.793, aug_score:25.487
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.512, aug_score:76.997
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.891, aug_score:67.063
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.161, aug_score:32.161
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:256.909, aug_score:253.262
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:83.934, aug_score:80.679
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:92.073, aug_score:77.874
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:42.159, aug_score:37.109
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:196.718, aug_score:179.174
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:115.837, aug_score:113.311
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:100.840, aug_score:100.840
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:67.948, aug_score:67.804
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:236.434, aug_score:232.092
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:147.750, aug_score:142.377
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:98.385, aug_score:97.384
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:72.263, aug_score:72.263
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:130.799, aug_score:121.647
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:199.953, aug_score:174.333
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.654, aug_score:112.483
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:114.736, aug_score:101.276
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:60.866, aug_score:54.403
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:202.544, aug_score:198.572
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:166.562, aug_score:154.319
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:149.092, aug_score:140.937
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_40.json
[Eval] Eval for epoch 40 finished with exit code 0
[2025-06-08 13:54:01] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.9740%.
[2025-06-08 13:54:01] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 40 is 15.974026739697225!
[2025-06-08 13:54:01] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.322728
[2025-06-08 13:54:01] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:54:01] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:54:07] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:54:11] CVRPTrainer.py(104) : Epoch  41: Train 500/500(100.0%)  Score: 0.2531,  Loss: -0.0058
[2025-06-08 13:54:12] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:54:12] CVRPTrainer.py(184) : Epoch  41/200: Time Est.: Elapsed[14.65m], Remain[56.80m]
[2025-06-08 13:54:12] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:54:12] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:54:17] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:54:23] CVRPTrainer.py(104) : Epoch  42: Train 500/500(100.0%)  Score: 0.2573,  Loss: -0.0056
[2025-06-08 13:54:23] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:54:23] CVRPTrainer.py(184) : Epoch  42/200: Time Est.: Elapsed[14.83m], Remain[55.80m]
[2025-06-08 13:54:23] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:54:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:54:28] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:54:34] CVRPTrainer.py(104) : Epoch  43: Train 500/500(100.0%)  Score: 0.2577,  Loss: -0.0063
[2025-06-08 13:54:34] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:54:34] CVRPTrainer.py(184) : Epoch  43/200: Time Est.: Elapsed[15.02m], Remain[54.82m]
[2025-06-08 13:54:34] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:54:34] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:54:39] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:54:45] CVRPTrainer.py(104) : Epoch  44: Train 500/500(100.0%)  Score: 0.2578,  Loss: -0.0065
[2025-06-08 13:54:45] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:54:45] CVRPTrainer.py(184) : Epoch  44/200: Time Est.: Elapsed[15.21m], Remain[53.91m]
[2025-06-08 13:54:45] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:54:45] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:54:51] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:54:56] CVRPTrainer.py(104) : Epoch  45: Train 500/500(100.0%)  Score: 0.2611,  Loss: -0.0056
[2025-06-08 13:54:56] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:54:56] CVRPTrainer.py(184) : Epoch  45/200: Time Est.: Elapsed[15.39m], Remain[53.02m]
[2025-06-08 13:54:56] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 45 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.515, aug_score:29.019
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.297, aug_score:15.297
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.709, aug_score:13.364
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:57.828, aug_score:57.828
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.767, aug_score:29.298
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.164, aug_score:13.914
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.131, aug_score:16.131
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.112, aug_score:46.180
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.679, aug_score:17.285
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.138, aug_score:14.922
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.091, aug_score:21.091
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.833, aug_score:49.030
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.923, aug_score:52.267
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.832, aug_score:26.328
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.904, aug_score:25.867
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.030, aug_score:17.968
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.375, aug_score:48.430
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.042, aug_score:61.288
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.690, aug_score:32.384
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.442, aug_score:120.539
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.895, aug_score:42.623
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.428, aug_score:29.042
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:87.086, aug_score:86.769
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.402, aug_score:41.797
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.323, aug_score:40.924
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.107, aug_score:29.035
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.700, aug_score:81.700
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.115, aug_score:38.600
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.758, aug_score:36.758
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.685, aug_score:22.527
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:102.720, aug_score:102.464
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:52.148, aug_score:51.835
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.038, aug_score:37.743
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.089, aug_score:24.449
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.863, aug_score:29.385
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.973, aug_score:101.630
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:90.627, aug_score:81.603
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.008, aug_score:31.507
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.546, aug_score:33.917
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:152.428, aug_score:151.366
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.645, aug_score:47.573
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.863, aug_score:29.700
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.745, aug_score:26.360
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:157.965, aug_score:157.946
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.448, aug_score:73.693
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.424, aug_score:45.165
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.403, aug_score:25.459
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.086, aug_score:77.086
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.183, aug_score:66.722
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.772, aug_score:30.772
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:255.584, aug_score:253.592
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.026, aug_score:79.495
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:91.703, aug_score:78.305
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:41.207, aug_score:36.553
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:196.285, aug_score:180.987
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:117.266, aug_score:113.332
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:101.426, aug_score:101.426
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.427, aug_score:67.922
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:241.359, aug_score:233.644
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:146.885, aug_score:142.482
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:95.397, aug_score:94.375
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:72.295, aug_score:72.295
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:133.665, aug_score:125.819
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:198.131, aug_score:176.745
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.782, aug_score:111.408
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:110.879, aug_score:102.976
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:63.911, aug_score:54.200
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:202.919, aug_score:200.675
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:161.593, aug_score:152.882
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:146.333, aug_score:140.284
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_45.json
[Eval] Eval for epoch 45 finished with exit code 0
[2025-06-08 13:55:50] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.9451%.
[2025-06-08 13:55:50] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 45 is 15.945063844190834!
[2025-06-08 13:55:50] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.028963
[2025-06-08 13:55:50] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:55:50] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:55:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:56:01] CVRPTrainer.py(104) : Epoch  46: Train 500/500(100.0%)  Score: 0.2623,  Loss: -0.0060
[2025-06-08 13:56:01] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:56:01] CVRPTrainer.py(184) : Epoch  46/200: Time Est.: Elapsed[16.48m], Remain[55.17m]
[2025-06-08 13:56:01] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:56:01] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:56:07] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:56:13] CVRPTrainer.py(104) : Epoch  47: Train 500/500(100.0%)  Score: 0.2679,  Loss: -0.0065
[2025-06-08 13:56:13] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:56:13] CVRPTrainer.py(184) : Epoch  47/200: Time Est.: Elapsed[16.67m], Remain[54.25m]
[2025-06-08 13:56:13] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:56:13] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:56:18] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:56:23] CVRPTrainer.py(104) : Epoch  48: Train 500/500(100.0%)  Score: 0.2559,  Loss: -0.0055
[2025-06-08 13:56:23] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:56:23] CVRPTrainer.py(184) : Epoch  48/200: Time Est.: Elapsed[16.84m], Remain[53.34m]
[2025-06-08 13:56:23] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:56:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:56:29] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:56:34] CVRPTrainer.py(104) : Epoch  49: Train 500/500(100.0%)  Score: 0.2613,  Loss: -0.0056
[2025-06-08 13:56:34] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:56:34] CVRPTrainer.py(184) : Epoch  49/200: Time Est.: Elapsed[17.03m], Remain[52.47m]
[2025-06-08 13:56:34] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:56:34] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:56:40] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:56:46] CVRPTrainer.py(104) : Epoch  50: Train 500/500(100.0%)  Score: 0.2577,  Loss: -0.0059
[2025-06-08 13:56:46] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:56:46] CVRPTrainer.py(184) : Epoch  50/200: Time Est.: Elapsed[17.22m], Remain[51.65m]
[2025-06-08 13:56:46] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 50 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.460, aug_score:29.041
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.335, aug_score:15.303
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.689, aug_score:13.233
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.252, aug_score:58.252
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.782, aug_score:29.298
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.969, aug_score:13.969
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.146, aug_score:16.102
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.429, aug_score:45.889
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.737, aug_score:17.401
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.216, aug_score:14.858
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.081, aug_score:21.081
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.164, aug_score:49.676
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.055, aug_score:51.982
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.311, aug_score:26.311
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.943, aug_score:25.841
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.179, aug_score:17.997
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.837, aug_score:48.446
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.262, aug_score:61.396
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.638, aug_score:32.262
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.226, aug_score:120.480
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.763, aug_score:42.429
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.355, aug_score:28.941
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.900, aug_score:86.900
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.732, aug_score:42.317
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.238, aug_score:41.088
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.382, aug_score:29.100
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:82.298, aug_score:81.503
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.126, aug_score:38.763
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.186, aug_score:37.081
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.486, aug_score:22.486
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:102.946, aug_score:102.489
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.190, aug_score:52.081
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.135, aug_score:37.845
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.264, aug_score:24.616
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.715, aug_score:29.322
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.724, aug_score:101.829
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:85.828, aug_score:82.029
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.511, aug_score:31.876
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.542, aug_score:33.831
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:151.862, aug_score:151.862
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:49.160, aug_score:48.077
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.068, aug_score:29.711
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.876, aug_score:26.369
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:157.633, aug_score:156.621
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.542, aug_score:73.812
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.120, aug_score:45.232
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.153, aug_score:25.066
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.108, aug_score:77.108
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.303, aug_score:66.876
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.820, aug_score:30.820
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:255.534, aug_score:251.332
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.656, aug_score:78.999
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:91.095, aug_score:77.980
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:41.409, aug_score:37.038
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:198.010, aug_score:185.033
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:114.160, aug_score:113.023
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:102.399, aug_score:102.399
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.352, aug_score:68.352
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:242.361, aug_score:230.215
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:146.148, aug_score:141.983
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:93.787, aug_score:92.830
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:71.903, aug_score:71.903
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:131.159, aug_score:127.752
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:200.694, aug_score:172.843
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:122.354, aug_score:110.003
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:110.693, aug_score:103.878
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:64.480, aug_score:54.528
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:203.522, aug_score:203.052
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:163.586, aug_score:156.269
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:146.504, aug_score:140.989
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_50.json
[Eval] Eval for epoch 50 finished with exit code 0
[2025-06-08 13:57:39] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.0688%.
[2025-06-08 13:57:39] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 50 is 16.068760720468713!
[2025-06-08 13:57:39] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.123697
[2025-06-08 13:57:39] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.9451%, current = 16.0688%. (1/8)
[2025-06-08 13:57:39] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:57:39] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:57:45] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:57:50] CVRPTrainer.py(104) : Epoch  51: Train 500/500(100.0%)  Score: 0.2599,  Loss: -0.0059
[2025-06-08 13:57:50] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:57:50] CVRPTrainer.py(184) : Epoch  51/200: Time Est.: Elapsed[18.29m], Remain[53.44m]
[2025-06-08 13:57:50] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:57:50] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:57:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:58:01] CVRPTrainer.py(104) : Epoch  52: Train 500/500(100.0%)  Score: 0.2548,  Loss: -0.0063
[2025-06-08 13:58:01] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:58:01] CVRPTrainer.py(184) : Epoch  52/200: Time Est.: Elapsed[18.48m], Remain[52.59m]
[2025-06-08 13:58:01] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:58:01] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:58:07] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:58:13] CVRPTrainer.py(104) : Epoch  53: Train 500/500(100.0%)  Score: 0.2585,  Loss: -0.0060
[2025-06-08 13:58:13] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:58:13] CVRPTrainer.py(184) : Epoch  53/200: Time Est.: Elapsed[18.67m], Remain[51.77m]
[2025-06-08 13:58:13] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:58:13] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:58:18] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:58:24] CVRPTrainer.py(104) : Epoch  54: Train 500/500(100.0%)  Score: 0.2639,  Loss: -0.0054
[2025-06-08 13:58:24] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:58:24] CVRPTrainer.py(184) : Epoch  54/200: Time Est.: Elapsed[18.85m], Remain[50.97m]
[2025-06-08 13:58:24] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:58:24] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:58:30] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:58:35] CVRPTrainer.py(104) : Epoch  55: Train 500/500(100.0%)  Score: 0.2572,  Loss: -0.0056
[2025-06-08 13:58:35] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:58:35] CVRPTrainer.py(184) : Epoch  55/200: Time Est.: Elapsed[19.04m], Remain[50.20m]
[2025-06-08 13:58:35] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 55 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.667, aug_score:29.046
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.367, aug_score:15.317
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.709, aug_score:13.359
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.384, aug_score:58.376
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.683, aug_score:29.233
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.013, aug_score:14.013
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.159, aug_score:16.133
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.713, aug_score:46.323
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.842, aug_score:17.443
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.107, aug_score:14.910
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.142, aug_score:21.142
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.884, aug_score:49.418
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.839, aug_score:51.474
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.431, aug_score:26.221
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.853, aug_score:25.811
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.205, aug_score:18.042
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.327, aug_score:48.103
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.341, aug_score:61.333
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.878, aug_score:32.387
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.682, aug_score:119.802
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.416, aug_score:42.334
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.511, aug_score:29.329
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.710, aug_score:86.537
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.615, aug_score:41.370
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.149, aug_score:40.947
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.091, aug_score:28.806
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:80.912, aug_score:80.705
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.198, aug_score:38.653
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.860, aug_score:36.696
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.683, aug_score:22.665
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:102.247, aug_score:102.108
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.285, aug_score:51.754
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.814, aug_score:37.565
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.128, aug_score:24.266
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.593, aug_score:29.231
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:101.576, aug_score:101.394
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:83.697, aug_score:81.525
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.247, aug_score:31.295
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.558, aug_score:33.893
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:151.416, aug_score:151.273
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.792, aug_score:47.526
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.112, aug_score:29.640
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.665, aug_score:26.520
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:156.349, aug_score:156.349
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:73.447, aug_score:73.284
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:45.461, aug_score:44.813
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.547, aug_score:25.242
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.365, aug_score:76.956
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.942, aug_score:67.259
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.715, aug_score:30.715
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:254.358, aug_score:250.992
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:83.189, aug_score:78.552
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:83.873, aug_score:78.922
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:40.662, aug_score:37.996
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:195.652, aug_score:185.259
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:112.541, aug_score:112.541
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:105.224, aug_score:103.334
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.490, aug_score:68.452
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:237.775, aug_score:225.938
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:144.191, aug_score:141.613
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:90.461, aug_score:90.461
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:71.638, aug_score:71.638
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:133.544, aug_score:124.647
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:200.728, aug_score:171.562
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:116.538, aug_score:109.811
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:109.379, aug_score:101.910
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:64.936, aug_score:55.035
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:201.226, aug_score:200.944
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:163.148, aug_score:155.019
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:144.515, aug_score:139.604
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_55.json
[Eval] Eval for epoch 55 finished with exit code 0
[2025-06-08 13:59:29] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.7111%.
[2025-06-08 13:59:29] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 55 is 15.71111781651967!
[2025-06-08 13:59:29] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.357643
[2025-06-08 13:59:29] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:59:29] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:59:34] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:59:40] CVRPTrainer.py(104) : Epoch  56: Train 500/500(100.0%)  Score: 0.2510,  Loss: -0.0057
[2025-06-08 13:59:40] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:59:40] CVRPTrainer.py(184) : Epoch  56/200: Time Est.: Elapsed[20.12m], Remain[51.73m]
[2025-06-08 13:59:40] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:59:40] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:59:45] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 13:59:51] CVRPTrainer.py(104) : Epoch  57: Train 500/500(100.0%)  Score: 0.2575,  Loss: -0.0056
[2025-06-08 13:59:51] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 13:59:51] CVRPTrainer.py(184) : Epoch  57/200: Time Est.: Elapsed[20.30m], Remain[50.94m]
[2025-06-08 13:59:51] CVRPTrainer.py(173) : =================================================================
[2025-06-08 13:59:51] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 13:59:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:00:02] CVRPTrainer.py(104) : Epoch  58: Train 500/500(100.0%)  Score: 0.2609,  Loss: -0.0060
[2025-06-08 14:00:02] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:00:02] CVRPTrainer.py(184) : Epoch  58/200: Time Est.: Elapsed[20.49m], Remain[50.15m]
[2025-06-08 14:00:02] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:00:02] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:00:08] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:00:13] CVRPTrainer.py(104) : Epoch  59: Train 500/500(100.0%)  Score: 0.2637,  Loss: -0.0057
[2025-06-08 14:00:13] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:00:13] CVRPTrainer.py(184) : Epoch  59/200: Time Est.: Elapsed[20.67m], Remain[49.39m]
[2025-06-08 14:00:13] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:00:13] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:00:18] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:00:23] CVRPTrainer.py(104) : Epoch  60: Train 500/500(100.0%)  Score: 0.2623,  Loss: -0.0057
[2025-06-08 14:00:23] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:00:23] CVRPTrainer.py(184) : Epoch  60/200: Time Est.: Elapsed[20.85m], Remain[48.64m]
[2025-06-08 14:00:23] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 60 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.412, aug_score:29.040
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.294, aug_score:15.294
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.323, aug_score:13.323
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.319, aug_score:58.319
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.676, aug_score:29.248
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.164, aug_score:13.992
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.175, aug_score:16.175
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.346, aug_score:45.890
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.905, aug_score:17.460
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.261, aug_score:14.805
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:20.944, aug_score:20.944
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.753, aug_score:49.224
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.971, aug_score:51.962
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.406, aug_score:26.317
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.919, aug_score:25.919
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.776, aug_score:17.776
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.916, aug_score:47.642
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:61.730, aug_score:61.242
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.789, aug_score:32.285
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.011, aug_score:120.086
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.645, aug_score:42.618
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.260, aug_score:29.003
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.641, aug_score:86.641
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.844, aug_score:42.101
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.249, aug_score:40.728
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.174, aug_score:29.174
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.115, aug_score:81.093
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.252, aug_score:38.301
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.255, aug_score:36.863
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.773, aug_score:22.472
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.246, aug_score:101.246
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.161, aug_score:51.430
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.120, aug_score:37.531
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.180, aug_score:24.453
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.606, aug_score:28.978
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.721, aug_score:101.688
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.384, aug_score:81.838
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.964, aug_score:31.648
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.107, aug_score:34.107
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:152.536, aug_score:151.664
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.877, aug_score:47.237
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.921, aug_score:29.779
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.539, aug_score:26.227
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:156.701, aug_score:156.701
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.126, aug_score:73.034
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:45.669, aug_score:45.335
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.131, aug_score:25.617
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.775, aug_score:77.034
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:67.947, aug_score:66.343
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.526, aug_score:31.526
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:255.041, aug_score:252.508
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.193, aug_score:78.690
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:94.539, aug_score:76.445
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:41.227, aug_score:36.336
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:191.799, aug_score:175.542
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:114.192, aug_score:111.145
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:102.581, aug_score:101.796
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.754, aug_score:68.185
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:239.668, aug_score:228.857
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:146.135, aug_score:141.165
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:90.803, aug_score:90.803
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:71.989, aug_score:71.989
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:138.520, aug_score:132.398
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:217.019, aug_score:185.777
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:120.432, aug_score:108.568
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:108.564, aug_score:104.837
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:62.737, aug_score:53.446
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:203.104, aug_score:199.124
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:166.284, aug_score:154.935
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:147.839, aug_score:142.449
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_60.json
[Eval] Eval for epoch 60 finished with exit code 0
[2025-06-08 14:01:17] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.7370%.
[2025-06-08 14:01:17] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 60 is 15.73699463289985!
[2025-06-08 14:01:17] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.025877
[2025-06-08 14:01:17] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 15.7370%. (1/8)
[2025-06-08 14:01:17] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:01:17] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:01:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:01:28] CVRPTrainer.py(104) : Epoch  61: Train 500/500(100.0%)  Score: 0.2588,  Loss: -0.0052
[2025-06-08 14:01:28] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:01:28] CVRPTrainer.py(184) : Epoch  61/200: Time Est.: Elapsed[21.92m], Remain[49.95m]
[2025-06-08 14:01:28] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:01:28] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:01:33] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:01:39] CVRPTrainer.py(104) : Epoch  62: Train 500/500(100.0%)  Score: 0.2595,  Loss: -0.0059
[2025-06-08 14:01:39] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:01:39] CVRPTrainer.py(184) : Epoch  62/200: Time Est.: Elapsed[22.11m], Remain[49.21m]
[2025-06-08 14:01:39] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:01:39] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:01:45] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:01:50] CVRPTrainer.py(104) : Epoch  63: Train 500/500(100.0%)  Score: 0.2609,  Loss: -0.0057
[2025-06-08 14:01:50] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:01:50] CVRPTrainer.py(184) : Epoch  63/200: Time Est.: Elapsed[22.29m], Remain[48.48m]
[2025-06-08 14:01:50] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:01:50] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:01:56] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:02:01] CVRPTrainer.py(104) : Epoch  64: Train 500/500(100.0%)  Score: 0.2551,  Loss: -0.0055
[2025-06-08 14:02:01] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:02:01] CVRPTrainer.py(184) : Epoch  64/200: Time Est.: Elapsed[22.47m], Remain[47.75m]
[2025-06-08 14:02:01] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:02:01] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:02:07] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:02:12] CVRPTrainer.py(104) : Epoch  65: Train 500/500(100.0%)  Score: 0.2584,  Loss: -0.0054
[2025-06-08 14:02:12] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:02:12] CVRPTrainer.py(184) : Epoch  65/200: Time Est.: Elapsed[22.66m], Remain[47.07m]
[2025-06-08 14:02:12] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 65 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.301, aug_score:28.980
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.250, aug_score:15.250
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.459, aug_score:13.141
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.167, aug_score:58.167
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.641, aug_score:29.308
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.134, aug_score:13.889
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.138, aug_score:16.084
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.859, aug_score:45.987
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.719, aug_score:17.364
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.214, aug_score:14.698
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:20.879, aug_score:20.879
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.215, aug_score:49.020
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.162, aug_score:51.353
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.433, aug_score:26.300
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.169, aug_score:25.817
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.001, aug_score:18.001
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.604, aug_score:47.694
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:61.912, aug_score:61.065
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.778, aug_score:32.277
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.429, aug_score:120.114
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.650, aug_score:42.590
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.260, aug_score:29.200
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.876, aug_score:86.242
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.383, aug_score:42.091
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:40.960, aug_score:40.877
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.961, aug_score:28.948
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.085, aug_score:80.858
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.848, aug_score:38.405
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.015, aug_score:36.915
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.664, aug_score:22.605
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.175, aug_score:101.175
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.806, aug_score:51.441
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.335, aug_score:37.754
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.491, aug_score:24.465
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:30.167, aug_score:29.341
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.552, aug_score:101.690
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.689, aug_score:81.917
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.504, aug_score:31.631
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:33.672, aug_score:33.672
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:151.909, aug_score:151.909
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:49.285, aug_score:47.185
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.020, aug_score:29.387
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.729, aug_score:26.634
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:157.005, aug_score:156.471
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:73.605, aug_score:73.013
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.110, aug_score:45.383
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:25.848, aug_score:25.151
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.498, aug_score:76.962
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.526, aug_score:66.946
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.659, aug_score:31.659
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:254.608, aug_score:253.720
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.558, aug_score:78.760
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:97.712, aug_score:76.999
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:40.778, aug_score:36.490
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:194.373, aug_score:174.957
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:114.743, aug_score:112.598
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:99.826, aug_score:99.545
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:69.569, aug_score:68.849
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:236.874, aug_score:231.007
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:147.247, aug_score:143.904
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:93.515, aug_score:93.515
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:71.194, aug_score:71.194
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:125.302, aug_score:123.971
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:195.616, aug_score:195.616
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:118.130, aug_score:110.589
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:109.632, aug_score:101.900
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:57.933, aug_score:51.850
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:205.018, aug_score:201.990
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:166.652, aug_score:157.741
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:147.477, aug_score:142.962
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_65.json
[Eval] Eval for epoch 65 finished with exit code 0
[2025-06-08 14:03:06] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.7905%.
[2025-06-08 14:03:06] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 65 is 15.790478783281202!
[2025-06-08 14:03:06] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.053484
[2025-06-08 14:03:06] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 15.7905%. (2/8)
[2025-06-08 14:03:06] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:03:06] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:03:11] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:03:17] CVRPTrainer.py(104) : Epoch  66: Train 500/500(100.0%)  Score: 0.2609,  Loss: -0.0058
[2025-06-08 14:03:17] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:03:17] CVRPTrainer.py(184) : Epoch  66/200: Time Est.: Elapsed[23.73m], Remain[48.18m]
[2025-06-08 14:03:17] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:03:17] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:03:23] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:03:28] CVRPTrainer.py(104) : Epoch  67: Train 500/500(100.0%)  Score: 0.2542,  Loss: -0.0059
[2025-06-08 14:03:28] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:03:28] CVRPTrainer.py(184) : Epoch  67/200: Time Est.: Elapsed[23.91m], Remain[47.47m]
[2025-06-08 14:03:28] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:03:28] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:03:33] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:03:39] CVRPTrainer.py(104) : Epoch  68: Train 500/500(100.0%)  Score: 0.2589,  Loss: -0.0060
[2025-06-08 14:03:39] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:03:39] CVRPTrainer.py(184) : Epoch  68/200: Time Est.: Elapsed[24.10m], Remain[46.79m]
[2025-06-08 14:03:39] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:03:39] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:03:45] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:03:50] CVRPTrainer.py(104) : Epoch  69: Train 500/500(100.0%)  Score: 0.2572,  Loss: -0.0054
[2025-06-08 14:03:50] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:03:50] CVRPTrainer.py(184) : Epoch  69/200: Time Est.: Elapsed[24.28m], Remain[46.10m]
[2025-06-08 14:03:50] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:03:50] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:03:55] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:04:01] CVRPTrainer.py(104) : Epoch  70: Train 500/500(100.0%)  Score: 0.2583,  Loss: -0.0052
[2025-06-08 14:04:01] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:04:01] CVRPTrainer.py(184) : Epoch  70/200: Time Est.: Elapsed[24.47m], Remain[45.44m]
[2025-06-08 14:04:01] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 70 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.398, aug_score:28.991
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.287, aug_score:15.287
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.601, aug_score:13.186
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.302, aug_score:58.302
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.614, aug_score:29.308
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.185, aug_score:13.947
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.150, aug_score:15.982
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:47.358, aug_score:45.698
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.703, aug_score:17.330
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.237, aug_score:14.685
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.050, aug_score:21.050
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.566, aug_score:48.880
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.688, aug_score:51.713
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.215, aug_score:26.215
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.055, aug_score:25.976
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.177, aug_score:17.975
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.771, aug_score:47.922
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.083, aug_score:61.338
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.781, aug_score:32.251
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.831, aug_score:120.424
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.666, aug_score:42.217
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.010, aug_score:29.010
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.161, aug_score:86.161
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.436, aug_score:42.106
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.273, aug_score:40.741
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.085, aug_score:29.085
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.482, aug_score:81.201
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.030, aug_score:38.199
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.009, aug_score:36.948
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.396, aug_score:22.396
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.699, aug_score:101.699
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.613, aug_score:51.484
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.808, aug_score:37.744
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.492, aug_score:24.421
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.853, aug_score:29.262
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.889, aug_score:101.723
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:87.963, aug_score:81.297
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.773, aug_score:31.651
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:34.078, aug_score:33.882
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:152.721, aug_score:151.325
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:47.472, aug_score:47.278
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.065, aug_score:29.681
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.789, aug_score:26.090
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:156.988, aug_score:155.708
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.339, aug_score:73.821
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:45.816, aug_score:45.032
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.035, aug_score:25.360
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:77.680, aug_score:77.338
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.670, aug_score:67.726
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.664, aug_score:31.664
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:254.842, aug_score:253.402
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.050, aug_score:78.909
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:94.711, aug_score:78.754
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:40.285, aug_score:36.749
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:197.756, aug_score:176.452
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:115.410, aug_score:112.368
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:100.342, aug_score:100.342
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.267, aug_score:68.088
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:239.151, aug_score:227.453
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:146.983, aug_score:141.874
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:93.280, aug_score:93.006
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:72.093, aug_score:72.093
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:129.586, aug_score:124.239
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:194.893, aug_score:194.893
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.107, aug_score:110.073
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:112.072, aug_score:100.219
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:58.419, aug_score:52.713
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:203.901, aug_score:199.670
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:171.811, aug_score:163.625
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:147.145, aug_score:142.511
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_70.json
[Eval] Eval for epoch 70 finished with exit code 0
[2025-06-08 14:04:54] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.8383%.
[2025-06-08 14:04:54] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 70 is 15.838268244986207!
[2025-06-08 14:04:54] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.047789
[2025-06-08 14:04:54] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 15.8383%. (3/8)
[2025-06-08 14:04:54] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:04:54] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:05:00] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:05:05] CVRPTrainer.py(104) : Epoch  71: Train 500/500(100.0%)  Score: 0.2606,  Loss: -0.0055
[2025-06-08 14:05:05] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:05:05] CVRPTrainer.py(184) : Epoch  71/200: Time Est.: Elapsed[25.54m], Remain[46.41m]
[2025-06-08 14:05:05] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:05:05] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:05:11] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:05:17] CVRPTrainer.py(104) : Epoch  72: Train 500/500(100.0%)  Score: 0.2544,  Loss: -0.0054
[2025-06-08 14:05:17] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:05:17] CVRPTrainer.py(184) : Epoch  72/200: Time Est.: Elapsed[25.73m], Remain[45.75m]
[2025-06-08 14:05:17] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:05:17] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:05:22] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:05:27] CVRPTrainer.py(104) : Epoch  73: Train 500/500(100.0%)  Score: 0.2572,  Loss: -0.0053
[2025-06-08 14:05:27] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:05:27] CVRPTrainer.py(184) : Epoch  73/200: Time Est.: Elapsed[25.91m], Remain[45.07m]
[2025-06-08 14:05:27] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:05:27] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:05:32] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:05:37] CVRPTrainer.py(104) : Epoch  74: Train 500/500(100.0%)  Score: 0.2537,  Loss: -0.0054
[2025-06-08 14:05:37] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:05:37] CVRPTrainer.py(184) : Epoch  74/200: Time Est.: Elapsed[26.08m], Remain[44.41m]
[2025-06-08 14:05:37] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:05:37] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:05:43] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:05:48] CVRPTrainer.py(104) : Epoch  75: Train 500/500(100.0%)  Score: 0.2554,  Loss: -0.0060
[2025-06-08 14:05:48] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:05:48] CVRPTrainer.py(184) : Epoch  75/200: Time Est.: Elapsed[26.26m], Remain[43.77m]
[2025-06-08 14:05:48] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 75 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.263, aug_score:28.971
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.276, aug_score:15.276
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.472, aug_score:13.227
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.247, aug_score:58.247
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.672, aug_score:29.296
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.944, aug_score:13.895
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.180, aug_score:16.097
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.675, aug_score:45.922
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.697, aug_score:17.493
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.158, aug_score:14.772
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:20.972, aug_score:20.972
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.431, aug_score:48.767
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.971, aug_score:51.610
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.802, aug_score:26.277
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.687, aug_score:25.687
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.112, aug_score:17.841
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.407, aug_score:47.842
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.166, aug_score:61.132
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.621, aug_score:32.339
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.574, aug_score:120.363
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.516, aug_score:42.516
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.769, aug_score:28.769
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.251, aug_score:86.251
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.734, aug_score:41.966
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.522, aug_score:40.711
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.027, aug_score:28.835
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.087, aug_score:81.087
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.571, aug_score:38.020
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.681, aug_score:36.681
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.556, aug_score:22.556
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.899, aug_score:101.899
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.455, aug_score:51.177
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.973, aug_score:37.696
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.448, aug_score:24.463
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.715, aug_score:29.262
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.564, aug_score:101.918
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.209, aug_score:81.811
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.529, aug_score:31.476
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:33.882, aug_score:33.882
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:153.153, aug_score:150.839
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:47.671, aug_score:47.191
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.072, aug_score:29.501
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.766, aug_score:26.507
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:156.972, aug_score:156.344
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.268, aug_score:73.720
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:45.694, aug_score:45.117
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.561, aug_score:25.326
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:76.975, aug_score:76.895
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.003, aug_score:67.005
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.147, aug_score:32.147
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:255.804, aug_score:252.046
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:83.935, aug_score:79.118
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:85.048, aug_score:76.690
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:41.203, aug_score:36.656
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:197.018, aug_score:176.070
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:113.353, aug_score:112.707
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:98.877, aug_score:98.877
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.164, aug_score:67.929
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:237.198, aug_score:226.425
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:145.676, aug_score:142.736
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:92.942, aug_score:92.942
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:71.783, aug_score:71.783
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:128.832, aug_score:123.197
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:200.731, aug_score:192.644
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:118.750, aug_score:110.554
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:112.060, aug_score:99.960
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:57.158, aug_score:52.992
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:203.173, aug_score:200.185
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:172.296, aug_score:163.311
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:149.485, aug_score:143.114
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_75.json
[Eval] Eval for epoch 75 finished with exit code 0
[2025-06-08 14:06:42] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 15.7207%.
[2025-06-08 14:06:42] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 75 is 15.720690799380021!
[2025-06-08 14:06:42] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.117577
[2025-06-08 14:06:42] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 15.7207%. (4/8)
[2025-06-08 14:06:42] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:06:42] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:06:48] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:06:53] CVRPTrainer.py(104) : Epoch  76: Train 500/500(100.0%)  Score: 0.2564,  Loss: -0.0068
[2025-06-08 14:06:53] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:06:53] CVRPTrainer.py(184) : Epoch  76/200: Time Est.: Elapsed[27.34m], Remain[44.60m]
[2025-06-08 14:06:53] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:06:53] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:06:59] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:07:04] CVRPTrainer.py(104) : Epoch  77: Train 500/500(100.0%)  Score: 0.2581,  Loss: -0.0059
[2025-06-08 14:07:04] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:07:04] CVRPTrainer.py(184) : Epoch  77/200: Time Est.: Elapsed[27.52m], Remain[43.96m]
[2025-06-08 14:07:04] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:07:04] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:07:09] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:07:15] CVRPTrainer.py(104) : Epoch  78: Train 500/500(100.0%)  Score: 0.2498,  Loss: -0.0052
[2025-06-08 14:07:15] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:07:15] CVRPTrainer.py(184) : Epoch  78/200: Time Est.: Elapsed[27.70m], Remain[43.33m]
[2025-06-08 14:07:15] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:07:15] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:07:21] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:07:26] CVRPTrainer.py(104) : Epoch  79: Train 500/500(100.0%)  Score: 0.2614,  Loss: -0.0057
[2025-06-08 14:07:26] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:07:26] CVRPTrainer.py(184) : Epoch  79/200: Time Est.: Elapsed[27.89m], Remain[42.71m]
[2025-06-08 14:07:26] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:07:26] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:07:31] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:07:37] CVRPTrainer.py(104) : Epoch  80: Train 500/500(100.0%)  Score: 0.2560,  Loss: -0.0058
[2025-06-08 14:07:37] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:07:37] CVRPTrainer.py(184) : Epoch  80/200: Time Est.: Elapsed[28.07m], Remain[42.11m]
[2025-06-08 14:07:37] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 80 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.378, aug_score:28.981
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.318, aug_score:15.191
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.349, aug_score:13.218
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.064, aug_score:58.064
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.631, aug_score:29.291
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.214, aug_score:14.067
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.084, aug_score:15.977
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.287, aug_score:45.918
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.701, aug_score:17.458
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.102, aug_score:14.861
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.072, aug_score:21.068
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.802, aug_score:49.212
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.789, aug_score:51.880
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.236, aug_score:26.220
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.149, aug_score:26.149
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.202, aug_score:17.933
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:49.097, aug_score:47.724
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:61.962, aug_score:61.409
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.817, aug_score:32.269
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.220, aug_score:120.220
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.431, aug_score:42.431
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.917, aug_score:28.838
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.953, aug_score:86.543
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.910, aug_score:42.097
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.271, aug_score:40.930
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.156, aug_score:29.040
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.596, aug_score:81.021
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.555, aug_score:38.430
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.005, aug_score:36.427
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.481, aug_score:22.481
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.974, aug_score:101.974
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.072, aug_score:51.261
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.255, aug_score:37.735
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.396, aug_score:24.349
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.760, aug_score:29.527
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.201, aug_score:101.873
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:85.464, aug_score:81.867
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.289, aug_score:31.637
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:33.718, aug_score:33.718
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:151.338, aug_score:151.084
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:47.984, aug_score:47.272
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.317, aug_score:29.219
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.564, aug_score:26.318
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:157.561, aug_score:157.531
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.422, aug_score:73.737
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.103, aug_score:44.867
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:25.449, aug_score:25.449
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.018, aug_score:77.248
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.415, aug_score:67.451
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.904, aug_score:31.904
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:256.080, aug_score:252.865
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.045, aug_score:79.357
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:88.547, aug_score:77.301
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:43.910, aug_score:37.354
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:197.519, aug_score:176.248
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:113.931, aug_score:112.540
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:99.986, aug_score:99.478
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.672, aug_score:68.164
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:237.938, aug_score:229.193
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:146.888, aug_score:144.748
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:92.187, aug_score:92.187
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:72.424, aug_score:72.424
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:140.287, aug_score:120.789
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:195.427, aug_score:195.427
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:118.943, aug_score:111.301
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:113.318, aug_score:102.253
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:59.837, aug_score:54.304
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:205.905, aug_score:200.108
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:174.707, aug_score:165.839
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:150.587, aug_score:143.513
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_80.json
[Eval] Eval for epoch 80 finished with exit code 0
[2025-06-08 14:08:30] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.0726%.
[2025-06-08 14:08:30] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 80 is 16.072565422295867!
[2025-06-08 14:08:30] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.351875
[2025-06-08 14:08:30] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 16.0726%. (5/8)
[2025-06-08 14:08:30] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:08:30] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:08:36] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:08:42] CVRPTrainer.py(104) : Epoch  81: Train 500/500(100.0%)  Score: 0.2567,  Loss: -0.0052
[2025-06-08 14:08:42] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:08:42] CVRPTrainer.py(184) : Epoch  81/200: Time Est.: Elapsed[29.15m], Remain[42.82m]
[2025-06-08 14:08:42] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:08:42] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:08:47] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:08:53] CVRPTrainer.py(104) : Epoch  82: Train 500/500(100.0%)  Score: 0.2599,  Loss: -0.0055
[2025-06-08 14:08:53] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:08:53] CVRPTrainer.py(184) : Epoch  82/200: Time Est.: Elapsed[29.34m], Remain[42.22m]
[2025-06-08 14:08:53] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:08:53] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:08:59] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:09:04] CVRPTrainer.py(104) : Epoch  83: Train 500/500(100.0%)  Score: 0.2567,  Loss: -0.0054
[2025-06-08 14:09:04] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:09:04] CVRPTrainer.py(184) : Epoch  83/200: Time Est.: Elapsed[29.53m], Remain[41.62m]
[2025-06-08 14:09:04] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:09:04] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:09:10] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:09:15] CVRPTrainer.py(104) : Epoch  84: Train 500/500(100.0%)  Score: 0.2624,  Loss: -0.0054
[2025-06-08 14:09:15] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:09:15] CVRPTrainer.py(184) : Epoch  84/200: Time Est.: Elapsed[29.71m], Remain[41.02m]
[2025-06-08 14:09:15] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:09:15] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:09:21] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:09:26] CVRPTrainer.py(104) : Epoch  85: Train 500/500(100.0%)  Score: 0.2535,  Loss: -0.0051
[2025-06-08 14:09:26] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:09:26] CVRPTrainer.py(184) : Epoch  85/200: Time Est.: Elapsed[29.89m], Remain[40.44m]
[2025-06-08 14:09:26] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 85 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.115, aug_score:28.844
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.390, aug_score:15.301
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.591, aug_score:13.203
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.296, aug_score:58.296
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.540, aug_score:29.341
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.942, aug_score:13.942
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.011, aug_score:16.010
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.024, aug_score:45.571
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.707, aug_score:17.446
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.101, aug_score:14.709
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.145, aug_score:21.145
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.706, aug_score:48.929
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.199, aug_score:51.777
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.372, aug_score:26.246
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.981, aug_score:25.872
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.004, aug_score:17.901
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.838, aug_score:47.158
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:62.222, aug_score:61.180
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.609, aug_score:32.594
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.119, aug_score:120.518
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.219, aug_score:42.178
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.881, aug_score:28.881
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.550, aug_score:86.257
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.188, aug_score:42.188
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.103, aug_score:40.886
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.029, aug_score:29.029
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.466, aug_score:81.179
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.950, aug_score:38.302
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.634, aug_score:36.634
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.396, aug_score:22.396
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.527, aug_score:101.527
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.788, aug_score:51.522
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.230, aug_score:37.734
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.189, aug_score:24.281
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.681, aug_score:29.280
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.448, aug_score:101.734
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:85.685, aug_score:81.505
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.152, aug_score:31.698
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:33.433, aug_score:33.433
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:151.033, aug_score:151.033
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.328, aug_score:47.707
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.138, aug_score:29.401
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.615, aug_score:26.460
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:157.005, aug_score:157.005
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.056, aug_score:73.749
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.141, aug_score:45.225
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:25.957, aug_score:24.998
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.771, aug_score:76.920
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.356, aug_score:67.038
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:31.609, aug_score:31.609
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:253.274, aug_score:249.450
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.360, aug_score:80.062
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.126, aug_score:77.330
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:42.960, aug_score:38.343
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:197.737, aug_score:174.691
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:114.759, aug_score:113.519
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:100.977, aug_score:100.977
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:68.624, aug_score:68.019
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:236.728, aug_score:227.546
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:150.697, aug_score:142.665
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:93.046, aug_score:93.046
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:72.606, aug_score:72.335
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:124.578, aug_score:124.578
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:194.250, aug_score:194.250
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.870, aug_score:111.845
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:113.601, aug_score:102.760
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:57.941, aug_score:53.418
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:203.023, aug_score:198.553
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:174.915, aug_score:167.474
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:151.274, aug_score:145.182
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_85.json
[Eval] Eval for epoch 85 finished with exit code 0
[2025-06-08 14:10:19] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.0623%.
[2025-06-08 14:10:19] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 85 is 16.06226830612616!
[2025-06-08 14:10:19] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.010297
[2025-06-08 14:10:19] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 16.0623%. (6/8)
[2025-06-08 14:10:19] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:10:19] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:10:25] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:10:31] CVRPTrainer.py(104) : Epoch  86: Train 500/500(100.0%)  Score: 0.2611,  Loss: -0.0053
[2025-06-08 14:10:31] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:10:31] CVRPTrainer.py(184) : Epoch  86/200: Time Est.: Elapsed[30.96m], Remain[41.05m]
[2025-06-08 14:10:31] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:10:31] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:10:36] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:10:42] CVRPTrainer.py(104) : Epoch  87: Train 500/500(100.0%)  Score: 0.2643,  Loss: -0.0053
[2025-06-08 14:10:42] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:10:42] CVRPTrainer.py(184) : Epoch  87/200: Time Est.: Elapsed[31.15m], Remain[40.46m]
[2025-06-08 14:10:42] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:10:42] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:10:47] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:10:52] CVRPTrainer.py(104) : Epoch  88: Train 500/500(100.0%)  Score: 0.2689,  Loss: -0.0057
[2025-06-08 14:10:52] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:10:52] CVRPTrainer.py(184) : Epoch  88/200: Time Est.: Elapsed[31.33m], Remain[39.87m]
[2025-06-08 14:10:52] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:10:52] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:10:58] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:11:03] CVRPTrainer.py(104) : Epoch  89: Train 500/500(100.0%)  Score: 0.2552,  Loss: -0.0055
[2025-06-08 14:11:03] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:11:03] CVRPTrainer.py(184) : Epoch  89/200: Time Est.: Elapsed[31.51m], Remain[39.29m]
[2025-06-08 14:11:03] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:11:03] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:11:09] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:11:14] CVRPTrainer.py(104) : Epoch  90: Train 500/500(100.0%)  Score: 0.2616,  Loss: -0.0057
[2025-06-08 14:11:14] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:11:14] CVRPTrainer.py(184) : Epoch  90/200: Time Est.: Elapsed[31.69m], Remain[38.73m]
[2025-06-08 14:11:14] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 90 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.565, aug_score:29.007
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.406, aug_score:15.249
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.577, aug_score:13.338
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.400, aug_score:58.091
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.570, aug_score:29.328
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:14.021, aug_score:14.021
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.041, aug_score:16.041
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.816, aug_score:45.477
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.890, aug_score:17.494
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.111, aug_score:14.778
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.056, aug_score:21.056
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.371, aug_score:48.944
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.684, aug_score:51.343
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.294, aug_score:26.249
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.740, aug_score:25.740
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.022, aug_score:17.871
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.648, aug_score:47.370
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:61.991, aug_score:61.014
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:33.175, aug_score:32.393
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:121.285, aug_score:121.019
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.862, aug_score:42.506
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.685, aug_score:29.292
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.594, aug_score:86.594
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.706, aug_score:42.240
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.210, aug_score:41.038
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.269, aug_score:29.132
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.018, aug_score:80.833
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.853, aug_score:38.623
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:36.891, aug_score:36.891
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.501, aug_score:22.501
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:101.953, aug_score:101.781
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:51.306, aug_score:51.306
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.232, aug_score:37.800
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.362, aug_score:24.538
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.529, aug_score:29.323
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:102.518, aug_score:101.862
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:88.823, aug_score:81.631
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.094, aug_score:31.850
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:33.913, aug_score:33.848
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:153.080, aug_score:151.805
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.072, aug_score:47.744
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:30.375, aug_score:29.565
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.799, aug_score:26.633
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:158.307, aug_score:157.066
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:73.578, aug_score:73.578
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:46.160, aug_score:44.996
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.077, aug_score:25.426
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:79.053, aug_score:76.831
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.196, aug_score:67.399
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.143, aug_score:32.143
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:256.211, aug_score:249.985
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:83.954, aug_score:79.855
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.119, aug_score:77.039
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:44.587, aug_score:38.991
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:200.290, aug_score:175.792
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:113.341, aug_score:113.341
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:102.840, aug_score:102.840
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:70.214, aug_score:68.349
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:236.638, aug_score:229.992
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:149.999, aug_score:141.168
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:92.963, aug_score:92.963
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:73.274, aug_score:73.274
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:143.142, aug_score:122.248
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:195.078, aug_score:195.078
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:120.787, aug_score:112.412
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:114.333, aug_score:102.753
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:60.936, aug_score:56.531
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:204.532, aug_score:199.472
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:175.496, aug_score:169.255
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:150.545, aug_score:146.809
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_90.json
[Eval] Eval for epoch 90 finished with exit code 0
[2025-06-08 14:12:08] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.5331%.
[2025-06-08 14:12:08] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 90 is 16.533085794099957!
[2025-06-08 14:12:08] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: -0.470817
[2025-06-08 14:12:08] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 16.5331%. (7/8)
[2025-06-08 14:12:08] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:12:08] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:12:13] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:12:19] CVRPTrainer.py(104) : Epoch  91: Train 500/500(100.0%)  Score: 0.2521,  Loss: -0.0056
[2025-06-08 14:12:19] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:12:19] CVRPTrainer.py(184) : Epoch  91/200: Time Est.: Elapsed[32.77m], Remain[39.25m]
[2025-06-08 14:12:19] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:12:19] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:12:25] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:12:30] CVRPTrainer.py(104) : Epoch  92: Train 500/500(100.0%)  Score: 0.2597,  Loss: -0.0054
[2025-06-08 14:12:30] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:12:30] CVRPTrainer.py(184) : Epoch  92/200: Time Est.: Elapsed[32.95m], Remain[38.68m]
[2025-06-08 14:12:30] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:12:30] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:12:35] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:12:41] CVRPTrainer.py(104) : Epoch  93: Train 500/500(100.0%)  Score: 0.2511,  Loss: -0.0051
[2025-06-08 14:12:41] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:12:41] CVRPTrainer.py(184) : Epoch  93/200: Time Est.: Elapsed[33.13m], Remain[38.12m]
[2025-06-08 14:12:41] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:12:41] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:12:46] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:12:51] CVRPTrainer.py(104) : Epoch  94: Train 500/500(100.0%)  Score: 0.2527,  Loss: -0.0053
[2025-06-08 14:12:51] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:12:51] CVRPTrainer.py(184) : Epoch  94/200: Time Est.: Elapsed[33.31m], Remain[37.56m]
[2025-06-08 14:12:51] CVRPTrainer.py(173) : =================================================================
[2025-06-08 14:12:51] CVRPTrainer.py(89) : [DEBUG] --- Training episode 0/500
[2025-06-08 14:12:57] CVRPTrainer.py(89) : [DEBUG] --- Training episode 256/500
[2025-06-08 14:13:02] CVRPTrainer.py(104) : Epoch  95: Train 500/500(100.0%)  Score: 0.2598,  Loss: -0.0054
[2025-06-08 14:13:02] CVRPTrainer.py(107) : Training One Epoch is Done!
[2025-06-08 14:13:02] CVRPTrainer.py(184) : Epoch  95/200: Time Est.: Elapsed[33.49m], Remain[37.01m]
[2025-06-08 14:13:02] CVRPTrainer.py(193) : Saving trained_model

[Eval] Running eval: python POMO/eval_longTrain.py 95 ./POMO/result/phase1_checkpoints 1
Start test 1/70: X-n101-k25.pt
/home/ntu/anaconda3/envs/zjh/lib/python3.12/site-packages/torch/__init__.py:1144: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPTester.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_fullname, map_location=device)
/home/ntu/CVRP/POMO_CVRP_p1/POMO/CVRPEnv.py:91: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_dict = torch.load(filename, map_location=device)
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.418, aug_score:29.021
Running test for ./dataset/train1/X-n101-k25.pt with problem X-n101-k25.
Start test 2/70: X-n110-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.277, aug_score:15.277
Running test for ./dataset/train1/X-n110-k13.pt with problem X-n110-k13.
Start test 3/70: X-n115-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.531, aug_score:13.145
Running test for ./dataset/train1/X-n115-k10.pt with problem X-n115-k10.
Start test 4/70: X-n125-k30.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:58.573, aug_score:58.100
Running test for ./dataset/train1/X-n125-k30.pt with problem X-n125-k30.
Start test 5/70: X-n129-k18.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.769, aug_score:29.308
Running test for ./dataset/train1/X-n129-k18.pt with problem X-n129-k18.
Start test 6/70: X-n139-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:13.907, aug_score:13.907
Running test for ./dataset/train1/X-n139-k10.pt with problem X-n139-k10.
Start test 7/70: X-n143-k7.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:16.211, aug_score:16.002
Running test for ./dataset/train1/X-n143-k7.pt with problem X-n143-k7.
Start test 8/70: X-n148-k46.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:46.840, aug_score:45.439
Running test for ./dataset/train1/X-n148-k46.pt with problem X-n148-k46.
Start test 9/70: X-n157-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:17.796, aug_score:17.363
Running test for ./dataset/train1/X-n157-k13.pt with problem X-n157-k13.
Start test 10/70: X-n162-k11.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:15.152, aug_score:14.850
Running test for ./dataset/train1/X-n162-k11.pt with problem X-n162-k11.
Start test 11/70: X-n167-k10.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:21.079, aug_score:21.079
Running test for ./dataset/train1/X-n167-k10.pt with problem X-n167-k10.
Start test 12/70: X-n172-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:50.599, aug_score:48.808
Running test for ./dataset/train1/X-n172-k51.pt with problem X-n172-k51.
Start test 13/70: X-n176-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.411, aug_score:51.708
Running test for ./dataset/train1/X-n176-k26.pt with problem X-n176-k26.
Start test 14/70: X-n181-k23.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:26.407, aug_score:26.240
Running test for ./dataset/train1/X-n181-k23.pt with problem X-n181-k23.
Start test 15/70: X-n186-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.864, aug_score:25.864
Running test for ./dataset/train1/X-n186-k15.pt with problem X-n186-k15.
Start test 16/70: X-n190-k8.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:18.059, aug_score:17.813
Running test for ./dataset/train1/X-n190-k8.pt with problem X-n190-k8.
Start test 17/70: X-n195-k51.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:48.572, aug_score:47.677
Running test for ./dataset/train1/X-n195-k51.pt with problem X-n195-k51.
Start test 18/70: X-n200-k36.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:61.920, aug_score:61.134
Running test for ./dataset/train1/X-n200-k36.pt with problem X-n200-k36.
Start test 19/70: X-n209-k16.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:32.463, aug_score:32.359
Running test for ./dataset/train1/X-n209-k16.pt with problem X-n209-k16.
Start test 20/70: X-n219-k73.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:120.900, aug_score:120.684
Running test for ./dataset/train1/X-n219-k73.pt with problem X-n219-k73.
Start test 21/70: X-n223-k34.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:42.648, aug_score:42.456
Running test for ./dataset/train1/X-n223-k34.pt with problem X-n223-k34.
Start test 22/70: X-n237-k14.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.090, aug_score:29.090
Running test for ./dataset/train1/X-n237-k14.pt with problem X-n237-k14.
Start test 23/70: X-n242-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:86.337, aug_score:86.337
Running test for ./dataset/train1/X-n242-k48.pt with problem X-n242-k48.
Start test 24/70: X-n247-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:43.061, aug_score:42.015
Running test for ./dataset/train1/X-n247-k50.pt with problem X-n247-k50.
Start test 25/70: X-n251-k28.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:41.207, aug_score:40.901
Running test for ./dataset/train1/X-n251-k28.pt with problem X-n251-k28.
Start test 26/70: X-n261-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:28.887, aug_score:28.843
Running test for ./dataset/train1/X-n261-k13.pt with problem X-n261-k13.
Start test 27/70: X-n266-k58.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:81.460, aug_score:81.040
Running test for ./dataset/train1/X-n266-k58.pt with problem X-n266-k58.
Start test 28/70: X-n270-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:39.354, aug_score:38.703
Running test for ./dataset/train1/X-n270-k35.pt with problem X-n270-k35.
Start test 29/70: X-n280-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:37.219, aug_score:36.687
Running test for ./dataset/train1/X-n280-k17.pt with problem X-n280-k17.
Start test 30/70: X-n284-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:22.778, aug_score:22.665
Running test for ./dataset/train1/X-n284-k15.pt with problem X-n284-k15.
Start test 31/70: X-n289-k60.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:102.033, aug_score:102.033
Running test for ./dataset/train1/X-n289-k60.pt with problem X-n289-k60.
Start test 32/70: X-n294-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:52.351, aug_score:51.828
Running test for ./dataset/train1/X-n294-k50.pt with problem X-n294-k50.
Start test 33/70: X-n298-k31.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:38.310, aug_score:37.802
Running test for ./dataset/train1/X-n298-k31.pt with problem X-n298-k31.
Start test 34/70: X-n303-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:25.388, aug_score:24.590
Running test for ./dataset/train1/X-n303-k21.pt with problem X-n303-k21.
Start test 35/70: X-n308-k13.pt
INFO:trainer:episode   1/  1, Elapsed[0.00m], Remain[0.00m], score:29.320, aug_score:29.309
Running test for ./dataset/train1/X-n308-k13.pt with problem X-n308-k13.
Start test 36/70: X-n313-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:103.579, aug_score:101.913
Running test for ./dataset/train1/X-n313-k71.pt with problem X-n313-k71.
Start test 37/70: X-n317-k53.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:86.532, aug_score:81.621
Running test for ./dataset/train1/X-n317-k53.pt with problem X-n317-k53.
Start test 38/70: X-n327-k20.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.192, aug_score:32.150
Running test for ./dataset/train1/X-n327-k20.pt with problem X-n327-k20.
Start test 39/70: X-n331-k15.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:33.742, aug_score:33.742
Running test for ./dataset/train1/X-n331-k15.pt with problem X-n331-k15.
Start test 40/70: X-n336-k84.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:152.416, aug_score:151.295
Running test for ./dataset/train1/X-n336-k84.pt with problem X-n336-k84.
Start test 41/70: X-n344-k43.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:48.032, aug_score:47.249
Running test for ./dataset/train1/X-n344-k43.pt with problem X-n344-k43.
Start test 42/70: X-n351-k40.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:29.828, aug_score:29.327
Running test for ./dataset/train1/X-n351-k40.pt with problem X-n351-k40.
Start test 43/70: X-n367-k17.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.682, aug_score:26.350
Running test for ./dataset/train1/X-n367-k17.pt with problem X-n367-k17.
Start test 44/70: X-n376-k94.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:158.065, aug_score:157.754
Running test for ./dataset/train1/X-n376-k94.pt with problem X-n376-k94.
Start test 45/70: X-n384-k52.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:74.510, aug_score:73.452
Running test for ./dataset/train1/X-n384-k52.pt with problem X-n384-k52.
Start test 46/70: X-n393-k38.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:45.817, aug_score:44.734
Running test for ./dataset/train1/X-n393-k38.pt with problem X-n393-k38.
Start test 47/70: X-n411-k19.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:26.051, aug_score:25.164
Running test for ./dataset/train1/X-n411-k19.pt with problem X-n411-k19.
Start test 48/70: X-n429-k61.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:78.224, aug_score:76.731
Running test for ./dataset/train1/X-n429-k61.pt with problem X-n429-k61.
Start test 49/70: X-n449-k29.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:68.425, aug_score:67.106
Running test for ./dataset/train1/X-n449-k29.pt with problem X-n449-k29.
Start test 50/70: X-n459-k26.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:32.058, aug_score:32.058
Running test for ./dataset/train1/X-n459-k26.pt with problem X-n459-k26.
Start test 51/70: X-n469-k138.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:252.871, aug_score:249.684
Running test for ./dataset/train1/X-n469-k138.pt with problem X-n469-k138.
Start test 52/70: X-n491-k59.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.566, aug_score:79.691
Running test for ./dataset/train1/X-n491-k59.pt with problem X-n491-k59.
Start test 53/70: X-n502-k39.pt
INFO:trainer:episode   1/  1, Elapsed[0.01m], Remain[0.00m], score:84.832, aug_score:77.480
Running test for ./dataset/train1/X-n502-k39.pt with problem X-n502-k39.
Start test 54/70: X-n513-k21.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:44.349, aug_score:38.429
Running test for ./dataset/train1/X-n513-k21.pt with problem X-n513-k21.
Start test 55/70: X-n524-k153.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:199.658, aug_score:176.613
Running test for ./dataset/train1/X-n524-k153.pt with problem X-n524-k153.
Start test 56/70: X-n536-k96.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:115.097, aug_score:112.159
Running test for ./dataset/train1/X-n536-k96.pt with problem X-n536-k96.
Start test 57/70: X-n548-k50.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:101.840, aug_score:101.840
Running test for ./dataset/train1/X-n548-k50.pt with problem X-n548-k50.
Start test 58/70: X-n561-k42.pt
INFO:trainer:episode   1/  1, Elapsed[0.02m], Remain[0.00m], score:69.744, aug_score:68.823
Running test for ./dataset/train1/X-n561-k42.pt with problem X-n561-k42.
Start test 59/70: X-n586-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:236.274, aug_score:229.754
Running test for ./dataset/train1/X-n586-k159.pt with problem X-n586-k159.
Start test 60/70: X-n599-k92.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:147.894, aug_score:141.314
Running test for ./dataset/train1/X-n599-k92.pt with problem X-n599-k92.
Start test 61/70: X-n613-k62.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:93.888, aug_score:93.888
Running test for ./dataset/train1/X-n613-k62.pt with problem X-n613-k62.
Start test 62/70: X-n641-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.03m], Remain[0.00m], score:73.015, aug_score:72.808
Running test for ./dataset/train1/X-n641-k35.pt with problem X-n641-k35.
Start test 63/70: X-n655-k131.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:142.899, aug_score:121.926
Running test for ./dataset/train1/X-n655-k131.pt with problem X-n655-k131.
Start test 64/70: X-n670-k130.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:196.652, aug_score:194.855
Running test for ./dataset/train1/X-n670-k130.pt with problem X-n670-k130.
Start test 65/70: X-n685-k75.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:119.976, aug_score:113.112
Running test for ./dataset/train1/X-n685-k75.pt with problem X-n685-k75.
Start test 66/70: X-n701-k44.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:116.359, aug_score:100.012
Running test for ./dataset/train1/X-n701-k44.pt with problem X-n701-k44.
Start test 67/70: X-n716-k35.pt
INFO:trainer:episode   1/  1, Elapsed[0.04m], Remain[0.00m], score:59.851, aug_score:57.690
Running test for ./dataset/train1/X-n716-k35.pt with problem X-n716-k35.
Start test 68/70: X-n733-k159.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:204.796, aug_score:200.259
Running test for ./dataset/train1/X-n733-k159.pt with problem X-n733-k159.
Start test 69/70: X-n766-k71.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:174.428, aug_score:166.529
Running test for ./dataset/train1/X-n766-k71.pt with problem X-n766-k71.
Start test 70/70: X-n783-k48.pt
INFO:trainer:episode   1/  1, Elapsed[0.05m], Remain[0.00m], score:151.369, aug_score:143.545
Running test for ./dataset/train1/X-n783-k48.pt with problem X-n783-k48.
[Eval] Saved tester_logger_dict to ./eval_results/tester_logger_dict_95.json
[Eval] Eval for epoch 95 finished with exit code 0
[2025-06-08 14:13:56] CVRPTrainer.py(279) : [Eval] The average aug gap of 70 problems is 16.2958%.
[2025-06-08 14:13:56] CVRPTrainer.py(207) : The average AUG gap of validation set on epoch 95 is 16.29579334377644!
[2025-06-08 14:13:56] CVRPTrainer.py(211) : [EarlyStop] Last checkpoint avg gap diff: 0.237292
[2025-06-08 14:13:56] CVRPTrainer.py(220) : [EarlyStop] No improvement: best avg gap = 15.7111%, current = 16.2958%. (8/8)
[2025-06-08 14:13:56] CVRPTrainer.py(224) : [EarlyStop] Training stopped early due to no improvemnet for 8 epochs!
[2025-06-08 14:13:56] CVRPTrainer.py(225) : *********The best avg AUG gap found so far is 15.71111781651967% at epoch 55***********
[2025-06-08 14:13:56] CVRPTrainer.py(228) :  *** All training epochs is Done *** 
[TEST] Total execution time: 0h 34m 23s
